# Construction Defect Management System

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–µ—Ñ–µ–∫—Ç–∞–º–∏ –Ω–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –Ω–∞ FastAPI –∏ PostgreSQL.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã](#–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã)
- [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
- [API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#api-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞ **Database-per-Service**. –ö–∞–∂–¥—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –∏–º–µ–µ—Ç —Å–≤–æ—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ —á–µ—Ä–µ–∑ HTTP API.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
microservices-frameworks/
‚îú‚îÄ‚îÄ svc_gateway/          # API Gateway (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ svc_auth/            # ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–†–ï–ê–õ–ò–ó–û–í–ê–ù)
‚îú‚îÄ‚îÄ svc_projects/        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ (–º–æ–¥–µ–ª–∏ –≥–æ—Ç–æ–≤—ã)
‚îú‚îÄ‚îÄ svc_defects/         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ñ–µ–∫—Ç–∞–º–∏ (–º–æ–¥–µ–ª–∏ –≥–æ—Ç–æ–≤—ã)
‚îú‚îÄ‚îÄ svc_reports/         # –û—Ç—á–µ—Ç—ã (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ docker-compose.yml   # ‚úÖ –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ .env                 # ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è Docker
‚îî‚îÄ‚îÄ requirements.txt     # ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
```

---

## üîß –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã

### 1. **svc_auth** - –°–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù**

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- FastAPI
- PostgreSQL
- JWT (PyJWT)
- Bcrypt (—Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π)
- SQLAlchemy + Alembic

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–ª–æ–≥–∏–Ω) —Å –≤—ã–¥–∞—á–µ–π JWT —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ Role-based access control (4 —Ä–æ–ª–∏)
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- ‚úÖ –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç API –æ—Ç–≤–µ—Ç–æ–≤

**–†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- `ENGINEER` - –ò–Ω–∂–µ–Ω–µ—Ä (—Å–æ–∑–¥–∞–µ—Ç –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç –¥–µ—Ñ–µ–∫—Ç—ã)
- `ADMIN` - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä/–ú–µ–Ω–µ–¥–∂–µ—Ä (–ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø)
- `SUPERVISOR` - –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å (—á—Ç–µ–Ω–∏–µ + –æ—Ç—á–µ—Ç—ã)
- `CUSTOMER` - –ó–∞–∫–∞–∑—á–∏–∫ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ)

**API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
- `POST /api/v1/auth/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /api/v1/auth/login` - –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É (–ø–æ–ª—É—á–µ–Ω–∏–µ JWT)
- `GET /api/v1/users/me` - –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ñ–∏–ª—å
- `PATCH /api/v1/users/me` - –û–±–Ω–æ–≤–∏—Ç—å —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `GET /api/v1/users` - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ç–æ–ª—å–∫–æ ADMIN/SUPERVISOR)
- `GET /api/v1/users/{user_id}` - –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID (—Ç–æ–ª—å–∫–æ ADMIN/SUPERVISOR)

**–ü–æ—Ä—Ç:** `8001`

---

### 2. **svc_projects** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏

**–°—Ç–∞—Ç—É—Å:** üîÑ –ú–æ–¥–µ–ª–∏ –∏ —Å—Ö–µ–º—ã –≥–æ—Ç–æ–≤—ã, API –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** `projects_db`
**–ü–æ—Ä—Ç:** `8002`

**–ú–æ–¥–µ–ª–∏:**
- –ü—Ä–æ–µ–∫—Ç—ã (Projects)

**–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤
- –°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç—Ç–∞–ø–∞–º–∏: DESIGN, CONSTRUCTION, FINISHING, COMPLETED
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞–º–∏: ACTIVE, ON_HOLD, CLOSED

---

### 3. **svc_defects** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ñ–µ–∫—Ç–∞–º–∏

**–°—Ç–∞—Ç—É—Å:** üîÑ –ú–æ–¥–µ–ª–∏ –∏ —Å—Ö–µ–º—ã –≥–æ—Ç–æ–≤—ã, API –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** `defects_db`
**–ü–æ—Ä—Ç:** `8003`

**–ú–æ–¥–µ–ª–∏:**
- –î–µ—Ñ–µ–∫—Ç—ã (Defects)
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (Comment)
- –í–ª–æ–∂–µ–Ω–∏—è (Attachment)
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π (DefectHistory)

**–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –¥–µ—Ñ–µ–∫—Ç–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞–º–∏: NEW ‚Üí IN_PROGRESS ‚Üí ON_REVIEW ‚Üí CLOSED/CANCELED
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã: LOW, MEDIUM, HIGH, CRITICAL
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –¥–µ—Ñ–µ–∫—Ç–∞–º
- –ó–∞–≥—Ä—É–∑–∫–∞ –≤–ª–æ–∂–µ–Ω–∏–π
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

### 4. **svc_reports** - –û—Ç—á–µ—Ç—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

**–°—Ç–∞—Ç—É—Å:** üìã –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** `reports_db`
**–ü–æ—Ä—Ç:** `8004`

**–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –û—Ç—á–µ—Ç—ã –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º –∏ –ø–µ—Ä–∏–æ–¥–∞–º
- –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV/Excel

---

### 5. **svc_gateway** - API Gateway

**–°—Ç–∞—Ç—É—Å:** üìã –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è

**–ü–æ—Ä—Ç:** `8000`

**–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
- –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º
- –í–∞–ª–∏–¥–∞—Ü–∏—è JWT –Ω–∞ —É—Ä–æ–≤–Ω–µ gateway
- CORS –æ–±—Ä–∞–±–æ—Ç–∫–∞
- Rate limiting

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ë–î

–ö–∞–∂–¥—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –∏–º–µ–µ—Ç —Å–≤–æ—é **—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö** PostgreSQL:

| –°–µ—Ä–≤–∏—Å | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | –ü–æ—Ä—Ç (—Ö–æ—Å—Ç) |
|--------|-------------|--------------|-------------|
| svc_auth | `auth_db` | `app_user` | 5433 |
| svc_projects | `projects_db` | `projects_user` | 5434 |
| svc_defects | `defects_db` | `defects_user` | 5435 |
| svc_reports | `reports_db` | `reports_user` | 5436 |

### –¢–∞–±–ª–∏—Ü—ã

#### **svc_auth: –¢–∞–±–ª–∏—Ü–∞ `users`**

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| `id` | UUID | Primary Key |
| `full_name` | String(50) | –ü–æ–ª–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `email` | String(255) | Email (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π, –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π) |
| `hash_password` | String(128) | Bcrypt —Ö–µ—à –ø–∞—Ä–æ–ª—è |
| `role` | Enum | –†–æ–ª—å: engineer, admin, supervisor, customer |
| `is_active` | Boolean | –ê–∫—Ç–∏–≤–µ–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (default: true) |
| `created_at` | DateTime(TZ) | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `updated_at` | DateTime(TZ) | –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |

**–ò–Ω–¥–µ–∫—Å—ã:**
- `ix_users_email` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –Ω–∞ email

**Enum —Ç–∏–ø—ã:**
- `role`: engineer, admin, supervisor, customer

---

#### **svc_projects: –¢–∞–±–ª–∏—Ü–∞ `projects`**

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| `id` | UUID | Primary Key |
| `name` | String(255) | –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ |
| `code` | String(50) | –ö–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| `address` | String(255) | –ê–¥—Ä–µ—Å –æ–±—ä–µ–∫—Ç–∞ |
| `customer_name` | String(255) | –ò–º—è –∑–∞–∫–∞–∑—á–∏–∫–∞ |
| `stage` | Enum | –≠—Ç–∞–ø: DESIGN, CONSTRUCTION, FINISHING, COMPLETED |
| `status` | Enum | –°—Ç–∞—Ç—É—Å: ACTIVE, ON_HOLD, CLOSED |
| `manager_id` | UUID | ID –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π) |
| `start_date` | Date | –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| `end_date` | Date | –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| `created_at` | DateTime(TZ) | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `updated_at` | DateTime(TZ) | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |

**Enum —Ç–∏–ø—ã:**
- `project_stage`: DESIGN, CONSTRUCTION, FINISHING, COMPLETED
- `project_status`: ACTIVE, ON_HOLD, CLOSED

---

#### **svc_defects: –¢–∞–±–ª–∏—Ü–∞ `defects`**

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| `id` | UUID | Primary Key |
| `project_id` | UUID | ID –ø—Ä–æ–µ–∫—Ç–∞ (–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π) |
| `title` | String(255) | –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–µ—Ñ–µ–∫—Ç–∞ |
| `description` | Text | –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ |
| `priority` | Enum | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: LOW, MEDIUM, HIGH, CRITICAL |
| `status` | Enum | –°—Ç–∞—Ç—É—Å: NEW, IN_PROGRESS, ON_REVIEW, CLOSED, CANCELED |
| `author_id` | UUID | ID –∞–≤—Ç–æ—Ä–∞ (–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π) |
| `assignee_id` | UUID | ID –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è (–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, nullable) |
| `due_date` | Date | –°—Ä–æ–∫ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| `location` | String(255) | –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–µ—Ñ–µ–∫—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| `created_at` | DateTime(TZ) | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `updated_at` | DateTime(TZ) | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |

**Enum —Ç–∏–ø—ã:**
- `defect_priority`: LOW, MEDIUM, HIGH, CRITICAL
- `defect_status`: NEW, IN_PROGRESS, ON_REVIEW, CLOSED, CANCELED

---

#### **svc_defects: –¢–∞–±–ª–∏—Ü–∞ `comments`**

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| `id` | UUID | Primary Key |
| `defect_id` | UUID | Foreign Key ‚Üí defects.id (CASCADE DELETE) |
| `author_id` | UUID | ID –∞–≤—Ç–æ—Ä–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è |
| `text` | Text | –¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è |
| `created_at` | DateTime(TZ) | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |

---

#### **svc_defects: –¢–∞–±–ª–∏—Ü–∞ `attachments`**

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| `id` | UUID | Primary Key |
| `defect_id` | UUID | Foreign Key ‚Üí defects.id (CASCADE DELETE) |
| `file_url` | String(1024) | URL —Ñ–∞–π–ª–∞ |
| `file_name` | String(255) | –ò–º—è —Ñ–∞–π–ª–∞ |
| `uploaded_by_id` | UUID | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∑–∞–≥—Ä—É–∑–∏–≤—à–µ–≥–æ —Ñ–∞–π–ª |
| `uploaded_at` | DateTime(TZ) | –î–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏ |

---

#### **svc_defects: –¢–∞–±–ª–∏—Ü–∞ `defect_history`**

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| `id` | UUID | Primary Key |
| `defect_id` | UUID | Foreign Key ‚Üí defects.id (CASCADE DELETE) |
| `changed_by_id` | UUID | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤–Ω–µ—Å—à–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ |
| `field_name` | String(100) | –ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—è |
| `old_value` | String(255) | –°—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (nullable) |
| `new_value` | String(255) | –ù–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (nullable) |
| `changed_at` | DateTime(TZ) | –î–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è |

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.9+
- PostgreSQL 16
- Docker –∏ Docker Compose (–¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏)
- Git

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <repository-url>
cd microservices-frameworks
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### –î–ª—è Docker Compose

–ö–æ—Ä–Ω–µ–≤–æ–π `.env` —Ñ–∞–π–ª —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏:

```bash
# –§–∞–π–ª .env –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
# –°–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤—Å–µ—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
```

#### –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

–ö–∞–∂–¥—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –∏–º–µ–µ—Ç —Å–≤–æ–π `.env` —Ñ–∞–π–ª. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env.example` –≤ –∫–∞—á–µ—Å—Ç–≤–µ —à–∞–±–ª–æ–Ω–∞:

```bash
# –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ .env.example ‚Üí .env
cp svc_auth/.env.example svc_auth/.env
cp svc_projects/.env.example svc_projects/.env
cp svc_defects/.env.example svc_defects/.env
cp svc_reports/.env.example svc_reports/.env
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv .venv

# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
# macOS/Linux:
source .venv/bin/activate
# Windows:
.venv\Scripts\activate

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt
```

### 4. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
docker-compose up --build

# –ò–ª–∏ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
docker-compose up -d --build
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –¥–ª—è svc_auth:**

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose exec svc_auth alembic upgrade head
```

### 5. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)

#### –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL
psql -U postgres

# –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∫–æ–º–∞–Ω–¥—ã:
```

```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
CREATE DATABASE auth_db;
CREATE DATABASE projects_db;
CREATE DATABASE defects_db;
CREATE DATABASE reports_db;

-- –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–æ–ª–∏ –∏–∑ .env —Ñ–∞–π–ª–æ–≤)
CREATE USER app_user WITH PASSWORD 'Tr0p1c@lSunset#2024!xK9';
CREATE USER projects_user WITH PASSWORD 'Pr0j3cts*Core@2024#mN5w';
CREATE USER defects_user WITH PASSWORD 'D3f3cts*Mgmt@2024#pL7x';
CREATE USER reports_user WITH PASSWORD 'R3p0rts*Analytics@2024#vQ8y';

-- –í—ã–¥–∞—á–∞ –ø—Ä–∞–≤
GRANT ALL PRIVILEGES ON DATABASE auth_db TO app_user;
GRANT ALL PRIVILEGES ON DATABASE projects_db TO projects_user;
GRANT ALL PRIVILEGES ON DATABASE defects_db TO defects_user;
GRANT ALL PRIVILEGES ON DATABASE reports_db TO reports_user;

-- PostgreSQL 15+ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∞–≤ –Ω–∞ —Å—Ö–µ–º—É public
\c auth_db
GRANT ALL ON SCHEMA public TO app_user;
\c projects_db
GRANT ALL ON SCHEMA public TO projects_user;
\c defects_db
GRANT ALL ON SCHEMA public TO defects_user;
\c reports_db
GRANT ALL ON SCHEMA public TO reports_user;
```

#### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å–µ—Ä–≤–∏—Å–∞
cd svc_auth

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head

# –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞
cd ..
```

#### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

```bash
# –ò–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
uvicorn svc_auth.main:app --reload --port 8001

# –ò–ª–∏ –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–µ—Ä–≤–∏—Å–∞
cd svc_auth
python main.py
```

### 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∞–¥—Ä–µ—Å–∞–º:

- **svc_auth**: http://localhost:8001
  - Swagger UI: http://localhost:8001/docs
  - ReDoc: http://localhost:8001/redoc

---

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤ API

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç** –æ—Ç–≤–µ—Ç–æ–≤:

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "email": "user@example.com",
    ...
  }
}
```

**–û—à–∏–±–∫–∞:**
```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Invalid request data",
    "details": [...]
  }
}
```

### JWT –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–æ–∫–µ–Ω–∞:**
```json
{
  "sub": "user-uuid",
  "role": "engineer",
  "exp": 1234567890
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –î–æ–±–∞–≤—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Authorization –∫–æ –≤—Å–µ–º –∑–∞—â–∏—â–µ–Ω–Ω—ã–º –∑–∞–ø—Ä–æ—Å–∞–º
Authorization: Bearer <–≤–∞—à_jwt_—Ç–æ–∫–µ–Ω>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã JWT:**
- –ê–ª–≥–æ—Ä–∏—Ç–º: HS256
- –í—Ä–µ–º—è –∂–∏–∑–Ω–∏: 30 –º–∏–Ω—É—Ç (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- Secret key: –∑–∞–¥–∞–µ—Ç—Å—è –≤ `.env` (JWT_SECRET_KEY)

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)

```bash
curl -X POST "http://localhost:8001/api/v1/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "full_name": "Admin User",
    "email": "admin@example.com",
    "password": "SecurePass123!",
    "role": "admin",
    "is_active": true
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "full_name": "Admin User",
    "email": "admin@example.com",
    "role": "admin",
    "is_active": true,
    "created_at": "2024-11-22T12:00:00Z",
    "updated_at": "2024-11-22T12:00:00Z"
  }
}
```

### –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É

```bash
curl -X POST "http://localhost:8001/api/v1/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@example.com",
    "password": "SecurePass123!"
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "token_type": "bearer"
  }
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è

```bash
curl -X GET "http://localhost:8001/api/v1/users/me" \
  -H "Authorization: Bearer <your_token_here>"
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è

```bash
curl -X PATCH "http://localhost:8001/api/v1/users/me" \
  -H "Authorization: Bearer <your_token_here>" \
  -H "Content-Type: application/json" \
  -d '{
    "full_name": "Updated Name"
  }'
```

### –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è ADMIN/SUPERVISOR)

```bash
curl -X GET "http://localhost:8001/api/v1/users?skip=0&limit=10" \
  -H "Authorization: Bearer <admin_token_here>"
```

**–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:**
```bash
# –ü–æ —Ä–æ–ª–∏
curl "http://localhost:8001/api/v1/users?role=engineer" \
  -H "Authorization: Bearer <admin_token_here>"

# –ü–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
curl "http://localhost:8001/api/v1/users?is_active=true" \
  -H "Authorization: Bearer <admin_token_here>"
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π** - Bcrypt —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–æ–ª—å—é
2. **JWT —Ç–æ–∫–µ–Ω—ã** - –° –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏ (30 –º–∏–Ω)
3. **Role-based Access Control** - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ —É—Ä–æ–≤–Ω–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
4. **SQL Injection –∑–∞—â–∏—Ç–∞** - SQLAlchemy ORM
5. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - Pydantic —Å—Ö–µ–º—ã
6. **CORS** - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π CORS middleware
7. **–û—Ç–¥–µ–ª—å–Ω—ã–µ –ë–î –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** - –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∏–º–µ–µ—Ç —Å–≤–æ–π PostgreSQL user

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è production

- [ ] –ò–∑–º–µ–Ω–∏—Ç—å `JWT_SECRET_KEY` –Ω–∞ –∫—Ä–∏–ø—Ç–æ—Å—Ç–æ–π–∫–∏–π —Å–ª—É—á–∞–π–Ω—ã–π –∫–ª—é—á
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CORS –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤ –≤–º–µ—Å—Ç–æ `allow_origins=["*"]`
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS –¥–ª—è –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å rate limiting –Ω–∞ API Gateway
- [ ] –í–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å secrets management (HashiCorp Vault, AWS Secrets Manager)

---

## üîß –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### Alembic (–¥–ª—è svc_auth)

Alembic —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π:**
```bash
cd svc_auth
alembic upgrade head
```

**–û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–π:**
```bash
alembic downgrade -1  # –û—Ç–∫–∞—Ç–∏—Ç—å –æ–¥–Ω—É –º–∏–≥—Ä–∞—Ü–∏—é
alembic downgrade base  # –û—Ç–∫–∞—Ç–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
```

**–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:**
```bash
alembic revision --autogenerate -m "Description of changes"
```

**–ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–π:**
```bash
alembic history
```

**–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –ë–î:**
```bash
alembic current
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

–î–ª—è `svc_projects`, `svc_defects`, `svc_reports` –º–∏–≥—Ä–∞—Ü–∏–∏ **–µ—â–µ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã**.

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Alembic:**
```bash
cd svc_projects
alembic init alembic

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ alembic.ini –∏ alembic/env.py
# –ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
alembic revision --autogenerate -m "Initial migration"
alembic upgrade head
```

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```txt
fastapi              # Web framework
uvicorn[standard]    # ASGI server
SQLAlchemy           # ORM
alembic              # Database migrations
psycopg2-binary      # PostgreSQL adapter
python-dotenv        # Environment variables
pydantic             # Data validation
pydantic-settings    # Settings management
passlib[bcrypt]      # Password hashing
PyJWT                # JWT tokens
httpx                # HTTP client (–¥–ª—è –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤)
```

---

## üê≥ Docker

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Docker Compose

```yaml
services:
  - svc_auth (+ auth-db)
  - svc_projects (+ projects-db)
  - svc_defects (+ defects-db)
  - svc_reports (+ reports-db)
  - gateway (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
```

### –ö–æ–º–∞–Ω–¥—ã Docker Compose

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose down

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã
docker-compose build

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f svc_auth

# –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker-compose exec svc_auth alembic upgrade head

# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ volumes
docker-compose down -v
```

---

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–¥–µ—Ç–∞–ª—å–Ω–∞—è)

```
microservices-frameworks/
‚îú‚îÄ‚îÄ .env                          # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è Docker
‚îú‚îÄ‚îÄ .env.example                  # –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .gitignore                    # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ docker-compose.yml            # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt              # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ README.md                     # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îÇ
‚îú‚îÄ‚îÄ svc_auth/                     # ‚úÖ –°–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ .env                      # –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ .env.example              # –®–∞–±–ª–æ–Ω
‚îÇ   ‚îú‚îÄ‚îÄ alembic.ini               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                # Docker –æ–±—Ä–∞–∑
‚îÇ   ‚îú‚îÄ‚îÄ main.py                   # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ alembic/                  # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ env.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ versions/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ 0001_init_users.py
‚îÇ   ‚îú‚îÄ‚îÄ api/                      # API —Ä–æ—É—Ç–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deps.py               # Dependencies (get_current_user, require_role)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ v1/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ auth.py           # /register, /login
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ users.py          # /me, /users
‚îÇ   ‚îú‚îÄ‚îÄ core/                     # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py               # JWT —Å–æ–∑–¥–∞–Ω–∏–µ/–≤–∞–ª–∏–¥–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py             # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ .env
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ security.py           # –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ db/                       # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database.py           # SQLAlchemy setup
‚îÇ   ‚îú‚îÄ‚îÄ models/                   # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users.py              # Users model + Role enum
‚îÇ   ‚îî‚îÄ‚îÄ schemas/                  # Pydantic —Å—Ö–µ–º—ã
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ users.py              # UserCreate, UserRead, Token
‚îÇ
‚îú‚îÄ‚îÄ svc_projects/                 # –°–µ—Ä–≤–∏—Å –ø—Ä–æ–µ–∫—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ .env.example
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ projects.py           # Projects model + enums
‚îÇ   ‚îî‚îÄ‚îÄ schemas/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ projects.py           # ProjectCreate, ProjectRead
‚îÇ
‚îú‚îÄ‚îÄ svc_defects/                  # –°–µ—Ä–≤–∏—Å –¥–µ—Ñ–µ–∫—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ .env.example
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ defects.py            # Defects model + enums
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ comments.py           # Comment model
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ attachments.py        # Attachment model
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ defect_history.py    # DefectHistory model
‚îÇ   ‚îî‚îÄ‚îÄ schemas/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ defects.py            # –í—Å–µ —Å—Ö–µ–º—ã –¥–µ—Ñ–µ–∫—Ç–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ svc_reports/                  # –°–µ—Ä–≤–∏—Å –æ—Ç—á–µ—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ .env.example
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îî‚îÄ‚îÄ schemas/
‚îÇ       ‚îî‚îÄ‚îÄ __init__.py
‚îÇ
‚îî‚îÄ‚îÄ svc_gateway/                  # API Gateway
    ‚îú‚îÄ‚îÄ .env.example
    ‚îú‚îÄ‚îÄ Dockerfile
    ‚îú‚îÄ‚îÄ main.py
    ‚îî‚îÄ‚îÄ schemas/
        ‚îî‚îÄ‚îÄ __init__.py
```

---

## üéØ Roadmap

### –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è (v0.1)

- ‚úÖ –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (svc_auth) –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ Role-based access control
- ‚úÖ Docker Compose –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (v0.2)

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å API –¥–ª—è svc_projects
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å API –¥–ª—è svc_defects
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å API Gateway —Å –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

### –ë—É–¥—É—â–∏–µ –≤–µ—Ä—Å–∏–∏

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å svc_reports
- [ ] WebSocket –¥–ª—è real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (pytest)
- [ ] CI/CD pipeline
- [ ] Monitoring –∏ logging (Prometheus, Grafana, ELK)
- [ ] Rate limiting
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (OpenAPI 3.0)

---

## ü§ù Contributing

(–î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –≤–Ω–µ—Å–µ–Ω–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π)

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

(–î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ª–∏—Ü–µ–Ω–∑–∏–∏)

---

## üë• –ê–≤—Ç–æ—Ä—ã

(–î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–≤—Ç–æ—Ä–∞—Ö)

---

## üìß –ö–æ–Ω—Ç–∞–∫—Ç—ã

(–î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é)
